<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-partners/marketplace-integration" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Marketplace | SaaS Builder Toolkit for AWS (SBT-AWS)</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://awslabs.github.io/sbt-aws/docs/partners/marketplace-integration"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Marketplace | SaaS Builder Toolkit for AWS (SBT-AWS)"><meta data-rh="true" name="description" content="Provides usage-based billing support for SBT"><meta data-rh="true" property="og:description" content="Provides usage-based billing support for SBT"><link data-rh="true" rel="icon" href="/sbt-aws/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://awslabs.github.io/sbt-aws/docs/partners/marketplace-integration"><link data-rh="true" rel="alternate" href="https://awslabs.github.io/sbt-aws/docs/partners/marketplace-integration" hreflang="en"><link data-rh="true" rel="alternate" href="https://awslabs.github.io/sbt-aws/docs/partners/marketplace-integration" hreflang="x-default"><link rel="stylesheet" href="/sbt-aws/assets/css/styles.cb016cba.css">
<script src="/sbt-aws/assets/js/runtime~main.4452c180.js" defer="defer"></script>
<script src="/sbt-aws/assets/js/main.01a2ea14.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/sbt-aws/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/sbt-aws/"><div class="navbar__logo"><img src="/sbt-aws/img/logo.svg" alt="sbt logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/sbt-aws/img/logo.svg" alt="sbt logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">SBT-AWS</b></a><a class="navbar__item navbar__link" href="/sbt-aws/docs/category/sbt-tutorial---basics">Tutorial</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/sbt-aws/docs/category/isv-partner-integrations">Integrations</a><a class="navbar__item navbar__link" href="/sbt-aws/docs/interfaces">Interfaces</a><a class="navbar__item navbar__link" href="/sbt-aws/docs/reference_architectures/eks-reference-architecture">Reference Architectures</a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/sbt-aws/docs/category/isv-partner-integrations">ISV Partner Integrations</a><button aria-label="Expand sidebar category &#x27;ISV Partner Integrations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/sbt-aws/docs/partners/marketplace-integration">Marketplace</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/sbt-aws/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Marketplace</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>AWS Marketplace Integration</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>The AWS Marketplace integration with SBT consists of a set of CDK constructs that can accelerate the process of getting up and running with your SaaS listing on the AWS Marketplace. It provides a seamless integration between your SaaS product and the AWS Marketplace, enabling you to manage customer subscriptions, entitlements, and metering data.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-does-it-work">How does it work<a href="#how-does-it-work" class="hash-link" aria-label="Direct link to How does it work" title="Direct link to How does it work">​</a></h2>
<p>When a buyer subscribes to the SaaS product listed in the AWS Marketplace, they are redirected to the fulfillment URL specified for that listing. Using the optional <code>SampleRegistrationWebPage</code>, you can create a customizable landing page that can be used to gather more information about the buyer (step 4). This information can then be stored (step 5) and used to inform downstream processes like resource provisioning as part of the onboarding workflow, for example. For a detailed demonstration of the AWS Marketplace integration in action, check out our <a href="https://www.youtube.com/watch?v=G0JeP4Gj9x0" target="_blank" rel="noopener noreferrer">video walkthrough</a>.</p>
<p><img decoding="async" loading="lazy" alt="buyer-onboarding.png" src="/sbt-aws/assets/images/buyer-onboarding-f81e260242f2a004acc112727fc28562.png" width="751" height="555" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources-created">Resources created<a href="#resources-created" class="hash-link" aria-label="Direct link to Resources created" title="Direct link to Resources created">​</a></h2>
<p>Based on the <code>pricingModel</code> selected, a different combination of the following resources will be created:</p>
<p><img decoding="async" loading="lazy" alt="marketplace-resources.png" src="/sbt-aws/assets/images/marketplace-resources-13fb55be2b96d46887794d8f3b479356.png" width="1620" height="1155" class="img_ev3q"></p>
<ul>
<li>If <code>pricingModel</code> is set to <code>AWSMarketplaceSaaSPricingModel.CONTRACTS_WITH_SUBSCRIPTION</code>, then all resources shown above will be created.</li>
<li>If <code>pricingModel</code> is set to <code>AWSMarketplaceSaaSPricingModel.CONTRACTS</code>, then all resources except those marked with an orange circle will be created.</li>
<li>If <code>pricingModel</code> is set to <code>AWSMarketplaceSaaSPricingModel.SUBSCRIPTIONS</code>, then all resources except those marked with a purple circle will be created.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-resources">Key Resources<a href="#key-resources" class="hash-link" aria-label="Direct link to Key Resources" title="Direct link to Key Resources">​</a></h3>
<ol>
<li><strong>Subscribers Table</strong>: A DynamoDB table that stores information about the subscribers of your SaaS product, including their registration data and entitlement details.</li>
<li><strong>Entitlement Logic</strong>: A set of resources that handle the entitlement notifications from AWS Marketplace. It includes an SQS queue, an SNS topic subscription, and a Lambda function that processes the entitlement notifications and stores the subscriber information in the Subscribers Table.</li>
<li><strong>Subscription Logic</strong>: A set of resources that handle subscription-related events from AWS Marketplace. It includes a DynamoDB table for storing metering records, an SQS queue, and Lambda functions for processing metering data and sending it to AWS Marketplace.</li>
<li><strong>Registration API</strong>: An API Gateway REST API that exposes endpoints for redirecting buyers to the registration page and creating new subscribers in the Subscribers Table.</li>
<li><strong>Registration Web Page</strong>: An optional S3-hosted static website that provides a customizable registration page for buyers to submit their information. It is fronted by a CloudFront distribution for improved performance and security.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-marketplace-constructs">Creating the Marketplace Constructs<a href="#creating-the-marketplace-constructs" class="hash-link" aria-label="Direct link to Creating the Marketplace Constructs" title="Direct link to Creating the Marketplace Constructs">​</a></h2>
<p>The following CDK code shows how you can deploy the Marketplace integration along with SBT:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> sbt </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@cdklabs/sbt-aws&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">HelloCdkStack</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Stack</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scope</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Construct</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> props</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> StackProps</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scope</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> myControlPlane </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">sbt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ControlPlane</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;myControlPlane&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      systemAdminEmail</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;jane_doe@example.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> myProduct </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">sbt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">AWSMarketplaceSaaSProduct</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;myProduct&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      marketplaceTechAdminEmail</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;jane_doe@example.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      productCode</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;abcdef01234567890&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      entitlementSNSTopic</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;arn:aws:sns:us-east-1:111122223333:aws-mp-entitlement-notification-1234567890abcdef0&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      subscriptionSNSTopic</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;arn:aws:sns:us-east-1:111122223333:aws-mp-subscription-notification-021345abcdef6789&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      pricingModel</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> sbt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AWSMarketplaceSaaSPricingModel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">CONTRACTS_WITH_SUBSCRIPTION</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      eventManager</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> myControlPlane</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">eventManager</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      requiredFieldsForRegistration</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;name&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;address&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;phone&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">sbt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SampleRegistrationWebPage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;S3BucketProductRegistrationWebPage&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      registrationAPI</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> myProduct</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">registerCustomerAPI</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      userProvidedRequiredFieldsForRegistration</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> myProduct</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userProvidedRequiredFieldsForRegistration</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> app </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">cdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">App</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">HelloCdkStack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;HelloCdkStack&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  env</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// To use the Marketplace constructs, the region must be specified via environments at template synthesis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// see here: https://docs.aws.amazon.com/cdk/v2/guide/configure-env.html#configure-env-when</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    region</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;us-east-1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Marketplace construct currently only supports the us-east-1 region</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note: The following variables must be obtained from the SaaS listing created in the AWS Marketplace:</p>
<ul>
<li><code>productCode</code></li>
<li><code>entitlementSNSTopic</code></li>
<li><code>subscriptionSNSTopic</code></li>
</ul>
<p>(For more information on input parameters, refer to the <a href="https://constructs.dev/packages/@cdklabs/sbt-aws" target="_blank" rel="noopener noreferrer">documentation</a> on Construct Hub.)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="interaction-with-sbt">Interaction with SBT<a href="#interaction-with-sbt" class="hash-link" aria-label="Direct link to Interaction with SBT" title="Direct link to Interaction with SBT">​</a></h2>
<p>Once the Marketplace construct is connected to an SBT control plane (via the optional <code>eventManager</code> input parameter of the <code>AWSMarketplaceSaaSProduct</code> construct), you will be able to integrate SBT operations with Marketplace buyer lifecycle events.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="onboarding">Onboarding<a href="#onboarding" class="hash-link" aria-label="Direct link to Onboarding" title="Direct link to Onboarding">​</a></h3>
<p>When a buyer subscribes to your Marketplace listing and submits the fulfillment form, that information is combined with the entitlement information coming from Marketplace and used to create a <code>DetailType.ONBOARDING_REQUEST</code> event. This can then be used as a trigger for an onboarding job created as part of the <code>CoreApplicationPlane</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="offboarding">Offboarding<a href="#offboarding" class="hash-link" aria-label="Direct link to Offboarding" title="Direct link to Offboarding">​</a></h3>
<p>Similar to the onboarding event described above, a <code>DetailType.OFFBOARDING_REQUEST</code> event is emitted when a subscription expires. Just like the onboarding event, this event can also be used to trigger an offboarding job that perhaps cleans up the departing tenant&#x27;s resources.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="metering-with-aws-marketplace">Metering with AWS Marketplace<a href="#metering-with-aws-marketplace" class="hash-link" aria-label="Direct link to Metering with AWS Marketplace" title="Direct link to Metering with AWS Marketplace">​</a></h2>
<p>For pricing models that are usage based (i.e., <code>AWSMarketplaceSaaSPricingModel.CONTRACTS_WITH_SUBSCRIPTION</code> and <code>AWSMarketplaceSaaSPricingModel.SUBSCRIPTIONS</code>), you can send metered data to Marketplace by updating the Marketplace Metering Records table created by this integration.</p>
<p>The data to be inserted should be of the following format:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;create_timestamp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;N&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;CURRENT_TIMESTAMP&gt;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;customerIdentifier&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;S&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;CUSTOMER_IDENTIFIER&gt;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;dimension_usage&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;L&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;M&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;dimension&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;S&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;USAGE_DIMENSION_1&gt;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;value&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;N&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;USAGE_DIMENSION_1_VALUE&gt;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;metering_pending&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;S&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;true&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>where,</p>
<ul>
<li><code>create_timestamp</code> is the Epoch time.</li>
<li><code>customerIdentifier</code> is the customer identifier provided by the AWS Marketplace. (This is stored in the Marketplace Subscribers table.)</li>
<li><code>dimension_usage</code> is a list of dimensions and the corresponding usage that you want Marketplace to record.</li>
</ul>
<p>After inserting this data, you can either manually trigger the hourly Lambda function that sends the data to AWS Marketplace or wait for its automatic scheduled invocation. You can find this lambda by searching for a lambda with the keyword &quot;Hourly&quot; present in the name.</p>
<p>Once invoked, the lambda will flush that data to Marketplace. To see the result, go back to the entry you created in the Metering Records table. Once there, you should see that it has been updated to include the response from Marketplace as the metering record was submitted.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="customization">Customization<a href="#customization" class="hash-link" aria-label="Direct link to Customization" title="Direct link to Customization">​</a></h2>
<p>The AWS Marketplace integration constructs provide several customization options to tailor the integration to your specific needs:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="registration-page">Registration Page<a href="#registration-page" class="hash-link" aria-label="Direct link to Registration Page" title="Direct link to Registration Page">​</a></h3>
<p>When creating the <code>SampleRegistrationWebPage</code> construct, you can specify the following:</p>
<ul>
<li><code>imageLogoUrl</code>: The URL of the image logo to display on the registration page.</li>
<li><code>userProvidedRequiredFieldsForRegistration</code>: Additional fields that buyers must provide during the registration process. These fields will be added to the registration form dynamically.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="required-registration-fields">Required Registration Fields<a href="#required-registration-fields" class="hash-link" aria-label="Direct link to Required Registration Fields" title="Direct link to Required Registration Fields">​</a></h3>
<p>The <code>requiredFieldsForRegistration</code> property of the <code>AWSMarketplaceSaaSProduct</code> construct allows you to specify additional fields that buyers must provide during the registration process. These fields will be added to the registration form dynamically.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="seller-email">Seller Email<a href="#seller-email" class="hash-link" aria-label="Direct link to Seller Email" title="Direct link to Seller Email">​</a></h3>
<p>If you want to send email notifications to buyers during the registration process, you can provide the <code>marketplaceSellerEmail</code> property when creating the <code>AWSMarketplaceSaaSProduct</code> construct. This email address must be verified in Amazon SES and in &#x27;Production&#x27; mode.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>The AWS Marketplace integration with SBT provides a comprehensive set of constructs to streamline the process of listing and managing your SaaS product on the AWS Marketplace. By leveraging these constructs, you can handle customer subscriptions, entitlements, and metering data seamlessly, while also integrating with the SBT control plane for advanced onboarding and offboarding workflows.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/awslabs/sbt-aws/blob/main/website/docs/partners/marketplace-integration.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/sbt-aws/docs/partners/isv-integrations/moesif"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Moesif</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#how-does-it-work" class="table-of-contents__link toc-highlight">How does it work</a></li><li><a href="#resources-created" class="table-of-contents__link toc-highlight">Resources created</a><ul><li><a href="#key-resources" class="table-of-contents__link toc-highlight">Key Resources</a></li></ul></li><li><a href="#creating-the-marketplace-constructs" class="table-of-contents__link toc-highlight">Creating the Marketplace Constructs</a></li><li><a href="#interaction-with-sbt" class="table-of-contents__link toc-highlight">Interaction with SBT</a><ul><li><a href="#onboarding" class="table-of-contents__link toc-highlight">Onboarding</a></li><li><a href="#offboarding" class="table-of-contents__link toc-highlight">Offboarding</a></li></ul></li><li><a href="#metering-with-aws-marketplace" class="table-of-contents__link toc-highlight">Metering with AWS Marketplace</a></li><li><a href="#customization" class="table-of-contents__link toc-highlight">Customization</a><ul><li><a href="#registration-page" class="table-of-contents__link toc-highlight">Registration Page</a></li><li><a href="#required-registration-fields" class="table-of-contents__link toc-highlight">Required Registration Fields</a></li><li><a href="#seller-email" class="table-of-contents__link toc-highlight">Seller Email</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/awslabs/sbt-aws/blob/main/docs/public/README.md#tutorial" target="_blank" rel="noopener noreferrer" class="footer__link-item">Tutorial<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Get Involved</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/awslabs/sbt-aws" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Built with ❤️ at AWS <br> © 2025 Amazon.com, Inc. or its affiliates. All Rights Reserved</div></div></div></footer></div>
</body>
</html>